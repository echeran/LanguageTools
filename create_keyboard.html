<!DOCTYPE html>
<!-- saved from url=(0052)https://x20web.corp.google.com/~shuchen/vk/demo.html -->
<html><head>
    <title>Create a virtual keyboard layout</title>


  <link rel="stylesheet" href="/css/blueprint/screen.css" type="text/css" media="screen">
  <link rel="stylesheet" href="/css/blueprint/print.css" type="text/css" media="print">

  <!--[if lt IE 8]>
    <link rel="stylesheet" href="/css/blueprint/ie.css" type="text/css" media="screen, projection">
  <![endif]-->

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
   {% for font in font_list %}
    @font-face{
      font-family:"{{font.family}}";
      src:url("{{font.source}}");
      font-weight:normal;
      font-style:normal;
    }
    {% endfor %}

     /* https://stackoverflow.com/questions/21909994/css-keyboard-layout */
    .keyboardRow { text-align:center }
    .key { display:inline-block; border:1px solid red; padding:10px;margin-bottom:5px; }
    </style>

  <link rel="stylesheet" type="text/css" href="/css/fonts.css">

    <style>
      .default-font {
      font-family: "Arial,Helvetica";
      font-size:12px;
      }

     {% for font in font_list %}
      .{{font.family}} {
      font-family: "{{font.family}},Arial";
      font-size:18px;
      }
      {% endfor %}

    input {font-size:14px;}
    textarea {font-size:18; height:400px;}
    </style>

  <script src="/js/utils.js"></script>
  <script src="/js/vk-debug.js"></script>
  <script>
    var diff_list = [];  // needed for utils.js

    var controller, visible = true;
    function onPageLoaded() {
      var input = document.getElementById('t1');
      controller = new i18n.input.keyboard.Keyboard();
      onSizeSelected(document.getElementById("sizeSelector").value, 't1');
      {% for kb in kb_list %}
      controller.loadLayout('{{kb.shortName}}');
      {% endfor %}
      controller.reposition(input, 3, 4, [5, 0, 0, 0]);
      controller.activateLayout('{{kb_list.0.shortName}}');
      controller.register(input);
      controller.addEventListener(
          'kc',
          function() { visible = false; });
      input.focus();

      setFontFamily(document.getElementById("fontSelector").value);

      var selector = document.getElementById("setLayout");
      onLayoutSelected(selector.value);
    }

    function onLayoutSelected(layoutCode) {
      controller.activateLayout(layoutCode);
        var info = kb_info[layoutCode];
        if (info != null) {
            var area = document.getElementById("kb_instructions");
            if (area) {
                area.innerHTML = area.value = info[1];
            }
        }
    }

    function toggle() {
      if (controller) {
        controller.setVisible(visible = !visible);
      }
    }

    function clearText() {
      var field = document.getElementById('t1');
      field.value = '';
      field = document.getElementById('codepoints');
      field.value = '';
      document.getElementById('t1').focus();
    }

    function showCodePoints() {
      var src_field = document.getElementById('t1');
      var code_text = uplus(src_field.value);
      var dest_field = document.getElementById('codepoints');
      dest_field.value = code_text;
      document.getElementById('t1').focus();
    }

    function setKeyCapsFont(newFontFamily) {
      var keycaps = document.getElementsByClassName("vk-cap");
      for (var i = 0; i < keycaps.length; i++ ) {
        keycaps[i].style.fontFamily = newFontFamily;
      }
    }

    function setFontFamily(newFontFamily) {
      setKeyCapsFont(newFontFamily);

      var t1_element = document.getElementById('t1');
      t1_element.className = newFontFamily;
      t1_element.style.fontFamily = newFontFamily; //  + ",Arial";
    }

    function onLanguageSelected(newLangTag, textArea) {
      var t1_element = document.getElementById(textArea);
      t1_element.lang = newLangTag;
    }

    function onSizeSelected(newSize, textArea) {
      var t1_element = document.getElementById(textArea);
      t1_element.style.fontSize = newSize;
    }

    // Keyboard info.
    var kb_info = {
      {% for kb in kb_list %}
        {{kb.shortName}}: ["{{kb.longName}}", "{{kb.instructions}}" ],
        {%endfor%}
    };

  function layerClick(layer) {
    alert('Layer ' + layer);
   }

  function keyClick(key) {
    alert('Key ' + key);
  }

  function charClick(c) {
    alert('Char ' + c);
  }

  // Concepts for setting up a keyboard:
  //   a. a current key
  //   b. a current layer
  //   c. load by name
  //   d. save by name
  //   e. multiple characters / key
  //   f. space key is wider
  //   g. key may have special key cap string
  //   h. keyboard should have language associated

  function keyboard(name) {
    this.name = name;
    this.lang = '';
    this.rows = [];
    this.rules = [];  // patterns and replacement
  }

</script>

<body onload="onPageLoaded()">
<div class="container">
    <div class="span-16">
        <h2>Prototype keyboard tool</h2>
        <div id="layers">{% for layer in layers%}
            <span onclick="layerClick('{{layer.0}}');">{{layer.1}}</span>
            {% endfor %}
        </div>

        <div class="keyboard">
            {% for row in rows %}
            <div class="keyboardRow">
                {% for c in row %}
                <span class="key" id='{{c}}' onclick="keyClick('{{c}}');">{{c}}</span>
                {% endfor %}
            </div>
            {% endfor %}
        </div>

    </div>

    <div class="span-8 last">
        <p>Table of characters</p>
        {% for c in charsets %}
        <span onclick="charClick('{{c}}');">{{c}}</span>
        {% endfor %}
    </div>

</body>
</html>
